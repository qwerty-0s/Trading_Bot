# Specification: Morris MOEX Volume Hunter (v1.1)

## 1. Общее описание
Система предназначена для мониторинга фьючерсов Московской биржи на малых таймфреймах (5m, 10m, 15m). Цель — поиск качественных точек разворота на основе классических свечных паттернов Г. Морриса, подтвержденных всплеском объема и близостью к сильным ценовым уровням.

## 2. Алгоритм фильтрации (No-EMA Strategy)
Сигнал генерируется только при одновременном выполнении условий:
1. **Detection**: Обнаружен один из паттернов из списка (см. п. 3).
2. **Volume**: Объем текущей свечи > 1.5x от среднего объема за последние 20 свечей.
3. **Levels**: Цена закрытия находится в зоне ±0.2% от:
    * Дневного максимума/минимума (Daily H/L).
    * Глобального экстремума за последние 300 свечей.
4. **Counter-trend**: Наличие 3-7 свечей краткосрочного движения, противоположного паттерну (подтверждение потенциала разворота).
5. **Time**: Исключение времени клирингов (14:00-14:05, 18:50-19:05 МСК).

## 3. Поддерживаемые паттерны (TA-Lib)
К базовому набору добавлены более сложные модели Морриса:
* **Разворотные (Бычьи/Медвежьи):**
    * `CDLENGULFING`: Поглощение.
    * `CDLHAMMER` / `CDLSHOOTINGSTAR`: Молот / Падающая звезда.
    * `CDLMORNINGSTAR` / `CDLEVENINGSTAR`: Утренняя / Вечерняя звезда.
    * `CDLHARAMI`: Харами.
    * `CDLPIERCING` / `CDLDARKCLOUDCOVER`: Просвет в облаках / Завеса из темных облаков.
    * `CDLINVERTEDHAMMER`: Перевернутый молот.
* **Паттерны продолжения (для фильтрации):**
    * `CDLTASUKIGAP`: Разрыв Тасуки.
    * `CDL3LINESTRIKE`: Трехлинейный прорыв.

## 4. Требования к реализации
* **Data**: Адаптер для получения OHLCV через Alfa-Bank API или MOEX ISS.
* **Visual**: График `mplfinance` должен содержать:
    * Свечи и гистограмму объема.
    * Горизонтальные линии уровней (серый пунктир).
    * Красный маркер над свечой, вызвавшей сигнал.
* **Telegram**: Отправка в формате `Photo + Caption`. Обязателен механизм Cooldown (не более 1 сообщения на одну и ту же свечу одного тикера/таймфрейма).

## 5. Переменные окружения (.env)
```env
TELEGRAM_TOKEN=your_bot_token
CHAT_ID=your_chat_id
ALFA_API_KEY=your_key
TICKERS=Si-6.26,CNY-6.26,SR-6.26